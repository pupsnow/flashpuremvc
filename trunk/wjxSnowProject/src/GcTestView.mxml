<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
	layout="horizontal" width="100%" height="100%" 
	creationComplete="init()" xmlns:net="flash.net.*" xmlns:uiThumbnailsMap="uiThumbnailsMap.*">
 	
 	 <mx:Script>
        <![CDATA[
            import mx.graphics.ImageSnapshot;
            import mx.graphics.codec.*;

            private const jpegEnc:JPEGEncoder = new JPEGEncoder();
            private const xmlObj:XML = describeType(FileReference);
			
			private var fr:FileReference = new FileReference();
			private var timer : Timer;
            private function init():void {
            	timer = new Timer(500);
				timer.addEventListener( TimerEvent.TIMER, onTimerEvent );
				timer.start();
                textArea.text =  "测试测试";
               var o:Object = new Object();
				o.source = panel;
                aa.data = o;
            }
			private function onTimerEvent( event : TimerEvent ) : void
			{
				Application.application.dispatchEvent( new Event("updateImage") );
			}
            private function btn_click(evt:MouseEvent):void {
                var imageSnap:ImageSnapshot = ImageSnapshot.captureImage(panel, 0, jpegEnc);
                fr.save(imageSnap.data, "describeType.jpg");
            }
        ]]>
    </mx:Script>
	<uiThumbnailsMap:ItemRenderer  id="aa" width="200" height="200"/>
    <mx:VBox width="200" height="300">
	    	<mx:Panel id="panel"
		            width="1000"
		            height="1000"
		            verticalCenter="0"
		            horizontalCenter="0">
		        <mx:TextArea id="textArea"
		                editable="true"
		                width="100%"
		                height="100%" />
		        <mx:ControlBar horizontalAlign="right">
		           <mx:Button id="btn"
		                    label="Save"
		                    click="btn_click(event);" />
		        </mx:ControlBar>
		    </mx:Panel>
    </mx:VBox>
    
</mx:Application>

